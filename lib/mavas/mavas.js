var Mavas=function(t){function e(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=2)}([function(t,e,a){"use strict";function n(){!0===this.isInitialLoad&&(this.isInitialLoad=!1),void 0===this.isInitialLoad&&(this.isInitialLoad=!0)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){return Number(t.toFixed(e))},o=function(t){return/^[0-9]+$/.test(t)},r=function(t,e){for(var a=void 0,n=[],i=0,o=t.length;i<o;i++)void 0===(a=t[i][e])&&null===a||n.push(a);return n},l=function(t){"-"===t.style.top[0]?t.style.marginTop=t.style.top.slice(1):t.style.marginTop="-"+t.style.top,"-"===t.style.left[0]?t.style.marginLeft=t.style.left.slice(1):t.style.marginLeft="-"+t.style.left},s=function(t){t.style.marginTop=null,t.style.marginLeft=null},c=function(t,e){for(var a=void 0,n=t.length-1;n>=0;n--)if(!0===function(t,a,n){return e(t,a,n)}(t[n],n,t)){a=t[n];break}return a},u={toDecimal:i,isNumber:o,pluck:r,offsetCanvasPositionOnDrag:l,resetCanvasPositionAfterDrag:s,setIsInitialLoadIndicator:n,findLast:c};e.default=u},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),r=a(0),l=n(r),s=a(4),c=n(s),u=function(){function t(){i(this,t),this.customLayers=[]}return o(t,[{key:"createLayer",value:function(t){var e=void 0,a=void 0,n=void 0;switch(t.type){case"external":break;case"polyline":return e={type:t.type,id:t.id,data:t.data||[],cacheAlgo:t.cacheAlgo||"9 blocks",delay:t.delay&&l.default.isNumber(t.delay.interval)&&l.default.isNumber(t.delay.size)?{interval:Number(t.delay.interval),size:Number(t.delay.size)}:void 0,realtime:!0===t.realtime,color:t.color||"black"},!0===e.realtime&&(e.delay=void 0),this.createPalette(e);case"marker":if(e={type:t.type,id:t.id,data:t.data||[],realtime:!0===t.realtime},a=this.createPalette(e),t.tooltip){if(t.tooltip.length===e.data.length)return n=this.createLayer({type:"tooltip",data:{marker:e.data,tooltip:t.tooltip}}),{palette:a,paletteTooltip:n};throw new Error("tooltip length must equal to data points length")}return a;case"tooltip":return e=Object.assign({},t),this.createPalette(e);default:throw new Error("unknown layer type")}}},{key:"createPalette",value:function(t){var e=void 0;return e=new c.default(this.map,t),this.customLayers.push(e),e.importData(t.data),e}},{key:"draw",value:function(t){for(var e=void 0,a=void 0,n=0,i=this.customLayers.length;n<i;n++)a=this.customLayers[n],e=new AMap.CustomLayer(a.canvas,t),e.render=a.draw.bind(a),e.setMap(this.map)}}]),t}();e.default=u},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;var l=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),s=a(1),c=n(s),u=a(0),h=n(u),d=function(t){function e(t,a){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.map=new AMap.Map(t,a),n}return r(e,t),l(e,[{key:"setFit",value:function(t){var e=void 0;switch(t.option.type){case"polyline":e="polyline";break;case"marker":e="marker";break;default:throw new Error("unkown palette")}var a=f.pluck(t[e].original,"data"),n=f.pluck(a,"0"),i=f.pluck(a,"1"),o=Math.max.apply(null,n),r=Math.min.apply(null,n),l=Math.max.apply(null,i),s=Math.min.apply(null,i),c=new AMap.LngLat(o,l),u=new AMap.LngLat(r,s),h=new AMap.Bounds(u,c);this.map.setBounds(h)}}]),e}(c.default);e.default=d;var f=e.Util=h.default},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){this.marker={},this.marker.original=[];for(var e=0,a=t.length;e<a;e++){var n=t[e],i=e.toString();this.marker.original.push({data:n,lngLat:new AMap.LngLat(n[0],n[1]),flagDesc:i,flagDescLen:i.length})}}function o(){var t=this,e=void 0,a=void 0,n=function(){p?o():(h.src=u.default,h.onload=function(){o(),p=!0})},i=function(){p?r():(h.src=u.default,h.onload=function(){r(),p=!0})},o=function(){var n=new Date,i=void 0,o=void 0;t.virtualCtx.clearRect(0,0,t.virtualCanvas.width,t.virtualCanvas.height);for(var r=0,l=t.marker.cache.length;r<l;r++)if(e=t.marker.cache[r],e.data){switch(a=t.map.lngLatToContainer(e.lngLat),t.virtualCtx.drawImage(h,a.x-d/2,a.y-f),e.flagDescLen){case 1:i=a.x-3,o=a.y-15;break;case 2:i=a.x-6,o=a.y-15;break;default:i=a.x-9,o=a.y-15}t.virtualCtx.fillText(e.flagDesc,i,o)}t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.drawImage(t.virtualCanvas,0,0),console.log("canvas api uses "+(new Date-n)+"ms")},r=function(){var n=new Date,i=void 0,o=void 0,r=document.getElementById(t.option.id).parentNode;t.virtualCtx.clearRect(0,0,t.virtualCanvas.width,t.virtualCanvas.height);for(var l=0,c=t.marker.cache.length;l<c;l++)if(e=t.marker.cache[l],e.data){switch(a=t.map.lngLatToContainer(e.lngLat),t.virtualCtx.drawImage(h,a.x-d/2,a.y-f),e.flagDescLen){case 1:i=a.x-3,o=a.y-15;break;case 2:i=a.x-6,o=a.y-15;break;default:i=a.x-9,o=a.y-15}t.virtualCtx.fillText(e.flagDesc,i,o)}t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.drawImage(t.virtualCanvas,0,0),s.default.offsetCanvasPositionOnDrag(r),console.log("canvas api uses "+(new Date-n)+"ms")};s.default.setIsInitialLoadIndicator.call(this),!0===this.option.realtime?!0===this.isInitialLoad?(this.timerThreshold=100,this.setBoundLngLat(),this.cacheVisibleMarker(),n(),this.map.on("dragging",function(e){new Date-t.lastTimer<t.timerThreshold&&clearTimeout(t.timerId),t.timerId=setTimeout(function(){t.setBoundLngLat(),t.cacheVisibleMarker(),i()},t.timerThreshold),t.lastTimer=new Date}),this.map.on("zoomend",function(e){t.setBoundLngLat(),t.cacheVisibleMarker(),i(),t.lastTimer=new Date})):(s.default.resetCanvasPositionAfterDrag(document.getElementById(this.option.id).parentNode),this.lastTimer=new Date):(this.setBoundLngLat(),this.cacheVisibleMarker(),n())}function r(){var t=new Date;this.marker.cache=[];for(var e=0,a=this.marker.original.length;e<a;e++){var n=this.marker.original[e],i=n.data[0],o=n.data[1];i<=this.boundLngLat[0]&&o<=this.boundLngLat[1]&&i>=this.boundLngLat[2]&&o>=this.boundLngLat[3]?this.marker.cache.push(Object.assign({},n)):this.marker.cache.push({flagDesc:n.flagDesc,flagDescLen:n.flagDescLen})}console.log("cache function uses "+(new Date-t)+"ms")}Object.defineProperty(e,"__esModule",{value:!0});var l=a(0),s=n(l),c=a(7),u=n(c),h=document.createElement("img"),d=19,f=31,p=!1;e.default={importData:i,draw:o,cacheVisibleMarker:r}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),r=a(5),l=n(r),s=a(3),c=n(s),u=a(6),h=n(u),d=function(){function t(e,a){switch(i(this,t),a.type){case"polyline":this.importData=l.default.importData,this.draw=l.default.draw,this.cacheVisiblePolyline=l.default.cacheVisiblePolyline;break;case"marker":this.importData=c.default.importData,this.draw=c.default.draw,this.cacheVisibleMarker=c.default.cacheVisibleMarker;break;case"tooltip":this.importData=h.default.importData,this.draw=h.default.draw,this.cacheVisibleTooltip=h.default.cacheVisibleTooltip}this.map=e,this.option=a,this.canvas=document.createElement("canvas"),this.canvas.id=this.option.id,this.canvas.width=this.map.getSize().width,this.canvas.height=this.map.getSize().height,this.ctx=this.canvas.getContext("2d"),this.virtualCanvas=document.createElement("canvas"),this.virtualCanvas.width=this.map.getSize().width,this.virtualCanvas.height=this.map.getSize().height,this.virtualCtx=this.virtualCanvas.getContext("2d"),this.isInitialLoad=void 0}return o(t,[{key:"setBoundLngLat",value:function(){var t=void 0,e=void 0,a=void 0;t=this.map.getBounds(),a=t.getNorthEast(),e=t.getSouthWest(),this.boundLngLat=[a.lng,a.lat,e.lng,e.lat]}},{key:"setCentreLngLat",value:function(){var t=void 0;t=this.map.getCenter(),this.centreLngLat=[t.lng,t.lat]}}]),t}();e.default=d},function(t,e,a){"use strict";function n(t){this.polyline={},this.polyline.original=t}function i(){var t=this,e=function(){var e=new Date;t.virtualCtx.strokeStyle=t.option.color,t.virtualCtx.clearRect(0,0,t.canvas.width,t.canvas.height);for(var a=0,l=t.polyline.cache.length;a<l;a++){n=t.polyline.cache[a],t.virtualCtx.beginPath();for(var s=0,c=n.length;s<c;s++)i=n[s],o=new AMap.LngLat(i[0],i[1]),r=t.map.lngLatToContainer(o),t.virtualCtx.lineTo(r.x,r.y);t.virtualCtx.stroke()}t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.drawImage(t.virtualCanvas,0,0),console.log("canvas api uses "+(new Date-e)+"ms")},a=function(){var e=new Date,a=document.getElementById(t.option.id).parentNode;t.virtualCtx.strokeStyle=t.option.color,t.virtualCtx.clearRect(0,0,t.canvas.width,t.canvas.height);for(var s=0,c=t.polyline.cache.length;s<c;s++){n=t.polyline.cache[s],t.virtualCtx.beginPath();for(var u=0,h=n.length;u<h;u++)i=n[u],o=new AMap.LngLat(i[0],i[1]),r=t.map.lngLatToContainer(o),t.virtualCtx.lineTo(r.x,r.y);t.virtualCtx.stroke()}t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.drawImage(t.virtualCanvas,0,0),l.default.offsetCanvasPositionOnDrag(a),console.log("canvas api uses "+(new Date-e)+"ms")},n=void 0,i=void 0,o=void 0,r=void 0;l.default.setIsInitialLoadIndicator.call(this),!0===this.option.realtime?!0===this.isInitialLoad?(this.timerThreshold=100,this.setBoundLngLat(),this.setCentreLngLat(),this.cacheVisiblePolyline(),e(),this.map.on("dragging",function(e){new Date-t.lastTimer<t.timerThreshold&&clearTimeout(t.timerId),t.timerId=setTimeout(function(){t.setBoundLngLat(),t.setCentreLngLat(),t.cacheVisiblePolyline(),a()},t.timerThreshold),t.lastTimer=new Date}),this.map.on("zoomend",function(a){t.setBoundLngLat(),t.setCentreLngLat(),t.cacheVisiblePolyline(),e(),t.lastTimer=new Date})):(l.default.resetCanvasPositionAfterDrag(document.getElementById(this.option.id).parentNode),this.lastTimer=new Date):(this.setBoundLngLat(),this.setCentreLngLat(),this.cacheVisiblePolyline(),void 0===this.option.delay?e():function(){var e=function(e){for(var a=e*s,l=(e+1)*s>t.polyline.cache.length?t.polyline.cache.length:(e+1)*s;a<l;a++){n=t.polyline.cache[a],t.virtualCtx.beginPath();for(var c=0,u=n.length;c<u;c++)i=n[c],o=new AMap.LngLat(i[0],i[1]),r=t.map.lngLatToContainer(o),t.virtualCtx.lineTo(r.x,r.y);t.virtualCtx.stroke(),t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.drawImage(t.virtualCanvas,0,0)}},a=new Date,l=t.option.delay.interval,s=t.option.delay.size,c=0,u=t.polyline.cache.length/s;t.virtualCtx.strokeStyle=t.option.color,t.virtualCtx.clearRect(0,0,t.canvas.width,t.canvas.height),e(c),c++;var h=setInterval(function(){e(c),c+1>u&&clearInterval(h),c++},l);console.log("canvas api uses "+(new Date-a)+"ms")}(this.option.delay))}function o(){function t(t,e){var a=[t[0]-e[0],t[1]-e[1]],n=[t[0]-e[2],t[1]-e[3]];return a[0]<0&&a[1]<0&&n[0]>0&&n[1]>0?0:a[0]<0&&a[1]>0&&n[0]>0&&n[1]>0?1:a[0]>0&&a[1]>0?2:a[0]>0&&a[1]<0&&n[0]>0&&n[1]>0?3:a[0]>0&&a[1]<0&&n[0]>0&&n[1]<0?4:a[0]<0&&a[1]<0&&n[0]>0&&n[1]<0?5:n[0]<0&&n[1]<0?6:a[0]<0&&a[1]<0&&n[0]<0&&n[1]>0?7:a[0]<0&&a[1]>0&&n[0]<0&&n[1]>0?8:void 0}var e=this;switch(this.option.cacheAlgo){case"9 blocks":!function(){var a=new Date,n=function(){!0!==s.isDrawn&&r.push(s.lngLat),r.push(l.lngLat),s=Object.assign({},l,{isDrawn:!0})},i=function(){!0===s.isDrawn&&r.push(l.lngLat),0!==r.length&&(e.polyline.cache.push(r),r=[]),s=Object.assign({},l,{isDrawn:!1})},o=void 0,r=void 0,l={},s={},c=void 0,u=void 0;e.polyline.cache=[],u=Math.sqrt(e.centreLngLat[0]-e.boundLngLat[0]^e.centreLngLat[1]-e.boundLngLat[1]+2^2);for(var h=0,d=e.polyline.original.length;h<d;h++){o=e.polyline.original[h],r=[];for(var f=1,p=o.length;f<p;f++)if(1==f&&(s.lngLat=o[f-1],s.position=t(s.lngLat,e.boundLngLat),0===s.position&&(r.push(s.lngLat),s.isDrawn=!0)),l.lngLat=o[f],l.position=t(l.lngLat,e.boundLngLat),c=Math.abs(l.position-s.position),0!==l.position)if(0!==c){if(s.position%2!=0)switch(c){case 1:case 7:i();continue;case 4:n();continue}else switch(c){case 1:case 2:case 6:case 7:i();continue}var g=s.lngLat[1]-l.lngLat[1],v=l.lngLat[0]-s.lngLat[0],m=s.lngLat[0]*l.lngLat[1]-l.lngLat[0]*s.lngLat[1],L=Math.abs((g*e.centreLngLat[0]+v*e.centreLngLat[1]+m)/Math.sqrt(g^2+v^2));L>u?i():n()}else i();else n();0!==r.length&&(e.polyline.cache.push(r),r=[])}console.log("cache function uses "+(new Date-a)+"ms")}();break;case"simple":!function(){var t=new Date,a=void 0,n=void 0,i=void 0;a=e.boundLngLat[0]-e.boundLngLat[2],n=e.boundLngLat[1]-e.boundLngLat[3],i=[e.boundLngLat[2]-a,e.boundLngLat[3]-n,e.boundLngLat[0]+a,e.boundLngLat[1]+n],e.polyline.cache=[],e.polyline.original.forEach(function(t){var a=[];t.forEach(function(t){var e=t[0],n=t[1];e>=i[0]&&n>=i[1]&&e<=i[2]&&n<=i[3]&&a.push(t)}),0!==a.length&&e.polyline.cache.push(a)}),console.log("cache function uses "+(new Date-t)+"ms")}()}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(0),l=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default={importData:n,draw:i,cacheVisiblePolyline:o}},function(t,e,a){"use strict";function n(t){this.tooltip={},this.tooltip.original={},this.tooltip.original.marker=[],this.tooltip.original.tooltip=[];for(var e=0,a=t.marker.length;e<a;e++){var n=t.marker[e];this.tooltip.original.marker.push({data:n,lngLat:new AMap.LngLat(n[0],n[1]),id:e}),this.tooltip.original.tooltip.push(t.tooltip[e])}}function i(){var t=this,e=void 0,a=void 0;l.default.setIsInitialLoadIndicator.call(this),this.setBoundLngLat(),this.cacheVisibleTooltip(),!0===this.isInitialLoad&&(this.map.on("movestart",function(t){u=!0}),this.map.on("moveend",function(t){u=!1}),this.map.on("mousemove",function(n){!1===u&&(a=l.default.findLast(t.tooltip.cache,function(t,a,i){return e=t.boundPixcel,n.pixel.x<=e[0]&&n.pixel.y>=e[1]&&n.pixel.x>=e[2]&&n.pixel.y<=e[3]}),t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),a&&t.ctx.fillText(a.tooltip,a.boundPixcel[0],a.boundPixcel[3]))}))}function o(){var t=new Date,e=void 0;this.tooltip.cache=[];for(var a=0,n=this.tooltip.original.marker.length;a<n;a++){var i=this.tooltip.original.marker[a],o=this.tooltip.original.tooltip[a],r=i.data[0],l=i.data[1];r<=this.boundLngLat[0]&&l<=this.boundLngLat[1]&&r>=this.boundLngLat[2]&&l>=this.boundLngLat[3]&&(e=this.map.lngLatToContainer(i.lngLat),this.tooltip.cache.push(Object.assign({},i,{boundPixcel:[e.x+s/2,e.y-c,e.x-s/2,e.y],tooltip:o})))}console.log("cache function uses "+(new Date-t)+"ms")}Object.defineProperty(e,"__esModule",{value:!0});var r=a(0),l=function(t){return t&&t.__esModule?t:{default:t}}(r),s=19,c=31,u=!1;e.default={importData:n,draw:i,cacheVisibleTooltip:o}},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAhCAYAAAA74pBqAAACmElEQVR42qWUXUiTcRTG35Kiy+imCJISp+9mLmcrTae1/Nz0Iug2qCgMKyRik4r8zpzfm5predFlXdZNEfkJIVRQkkQRTfuSlLXMOTc1t9N5IAY25/a+Xfz4c855nh8MtglEFIaxxbuTMTPDzBSz9PcdwR73tXqrBkOzZxPTwPiMtiUqsQeo1EFU2sfwixl73JFDfk1ZsWVuKzNgsPqp5A6RsS8yuCPH+UFm2ypZUdNsHNNfbPOTEaIYQZ57o8zmkKyw0V1b1L5ABgdJBj30CbKCG67tjK/QvkKFjqBk0EMfHiGvfsaU3zZPBbeDskGfPWbhaN33wbwuP+XZA7JBHx5BX/NtRt+zTPreFdmgz55p4XDVl8CR3t/0v8Aj5F6fnM/tWaLcW8uyQZ89HiHnmvO1rtNLOl7IBX32jAnZVz/Ysi0uOtS9KBv02dMtZFW+z8yqmqSMLr9s0IdHwDc30/x2OLNxmg7afJJBD/3QzynDNJ7MLGo7PKS1LsQM8uihH5KBA5fH6rQ1nyjd6o0Z5NEL+wvSXnq1hZnQ3JyhfZ3zUUEOefTCZCC94uUxzZV3lNrhiQpyyEf8pwWai8/71bWfKaV9LiK4c24A+XVlaRdG1UxA1faLIoE7clFlQF3+7F5KlZPE1tkwsMcduZhkqedGVExQ0fqT/gV73GOWgb1lQw+SqycoscUdAjP2uEuSqc4O5IsVLyih2R0CM/aSZcozTzcwzoSGKdpj+UF4MWMvWQbE00+qE01vKN7iIrw812AvS5Z86rGoKBuiXU0uwotZtgwknXz0Mb7+K+HFLFmWIsRtZHYwYtLxu/d3m8cJL2bscZciQ2k/EHXmcsWJh14xp/I8ZoC7FJkSpXVQyvqYTBoEeKN9zD/ozGaYK5XXKgAAAABJRU5ErkJggg=="}]);